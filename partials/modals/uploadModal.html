<div class="modal-content">
	
	<div class="modal-header">
		<button type="button" class="close" aria-label="Close" ng-click="close()">
			<span aria-hidden="true">&times;</span>
		</button>
		<h4 class="modal-title" ng-bind="title"></h4>
	</div>
	
	<div class="modal-body uploadForm">
	
		<div class="upload-header">
			<div class="dropArea" uploader="uploader" nv-file-drop="" nv-file-over="" ng-click="openFileDialog($event)">
				<input ng-hide="1" type="file" nv-file-select="" uploader="uploader" multiple ng-click="$event.stopPropagation()" />
				<div class="plus" ng-include="'img/plus-sign.svg'"></div> <div>Quellen einfügen</div>
			</div>
			
			<div ng-show="uploader.queue.length" class="queueHeader">
			<table class="table">
				<thead>
					<tr ng-if="uploadType == 'source'">
						<th width="300">Name</th>
						<th>Metadaten</th>
						<th width="100" ng-show="uploader.isHTML5"></th>
						<th width="60">Status</th>
						<th width="30"></th>
					</tr>
					<tr ng-if="uploadType == 'model' || uploadType == 'zip'">
						<th>Name</th>
						<th width="100" ng-show="uploader.isHTML5"></th>
						<th width="60">Status</th>
						<th width="30"></th>
					</tr>
				</thead>
			</table>
			</div>
		</div>
		
		<div class="upload-body">
		
			<div ng-show="uploader.queue.length" class="queueBody">
			<table class="table">
				<tbody>
					<tr ng-if="uploadType == 'source'" ng-repeat="item in uploader.queue">
						<td width="300" class="uploadMeta">
							<div>
								<strong>{{ item.file.name }}</strong>
								&emsp; <small>{{ item.file.size/1024/1024|number:2 }}&nbsp;MB</small>
							</div>
							<div ng-show="uploader.isHTML5 && item.file.type != 'application/pdf'" ng-thumb="{ file: item._file, width: 270 }"></div>
							<img ng-show="item.file.type == 'application/pdf'" src="img/pdf-icon.png"/>
						</td>
						
						<td>
							<!-- Quellenformular -->
							<form class="form-horizontal">
								
								<div class="form-group">
									<label for="docType" class="control-label col-sm-3">Typ</label>
									<div class="col-sm-3" bs-tooltip="{title: 'Art der Quelle'}">
										<select id="docType" class="form-control input-sm" ng-model="item.sourceType">
											<option value="plan">Plan</option>
											<option value="picture">Fotografie</option>
											<option value="text">Text</option>
										</select>
									</div>
									<label ng-if="item.sourceType == 'text'" for="docLang" class="control-label col-sm-2">Sprache</label>
									<div ng-if="item.sourceType == 'text'" class="col-sm-3" bs-tooltip="{title: 'Sprache'}">
										<select id="docLang" class="form-control input-sm" ng-model="item.language">
											<option value="de">Deutsch</option>
											<option value="de_frak">Deutsch (Fraktur)</option>
											<option value="en">Englisch</option>
										</select>
									</div>
								</div>
								
								<div class="form-group" ng-class="item.titleError ? 'has-error' : ''">
									<label for="docTitle" class="control-label col-sm-3">Titel</label>
									<div class="col-sm-8">
										<input id="docTitle" type="text" class="form-control" ng-model="item.title" ng-focus="setTypeaheadArray('E35','content')" ng-blur="validateInput2(item, {prop: 'title', index: $index, label: 'E35'})" bs-typeahead bs-options="ta.content as ta.content for ta in suggestions" placeholder="z.B. Aufriss Ostfassade" bs-tooltip="{title: 'Einzigartiger Titel (*)'}"/>
									</div>
								</div>
								
								<div class="form-group" ng-hide="globals.useAuthor">
									<label for="docAuthor" class="control-label col-sm-3">Autor</label>
									<div class="col-sm-8">
										<input id="docAuthor" type="text" class="form-control" ng-model="item.author" ng-focus="setTypeaheadArray('E82','content')" ng-blur="validateInput2(item)" bs-typeahead bs-options="ta.content as ta.content for ta in suggestions" placeholder="z.B. Conrad Schick" bs-tooltip="{title: 'Wer hat die Quelle erstellt?'}"/>
									</div>
								</div>
								
								<div class="form-group" ng-hide="globals.useCreationDate">
									<label for="docCreationDate" class="control-label col-sm-3">Datierung</label>
									<div class="col-sm-8">
										<input id="docCreationDate" type="text" class="form-control" ng-model="item.creationDate" ng-focus="setTypeaheadArray('E61','content')" ng-blur="validateInput2(item)" bs-typeahead bs-options="ta.content as ta.content for ta in suggestions" placeholder="z.B. 1889" bs-tooltip="{title: 'Wann wurde die Quelle erstellt?'}"/>
									</div>
								</div>

								<div class="form-group">
									<label for="docRepros" class="control-label col-sm-3">Lit./publ. Repros</label>
									<div class="col-sm-8">
										<input id="docRepros" type="text" class="form-control" ng-model="item.repros" placeholder="z.B. Franz 1953, Abb. 1"/>
									</div>
								</div>
								
								<div class="form-group large">
									<label for="docComment" class="control-label col-sm-3">Sonstiges</label>
									<div class="col-sm-8">
										<textarea class="form-control" id="docComment" ng-model="item.comment" bs-tooltip="{title: 'Wichtige Anmerkungen'}"></textarea>
									</div>
								</div>
								
								<div class="form-extend-btn" ng-click="item.formExtend = !item.formExtend"><span class="glyphicon" ng-class="item.formExtend?'glyphicon-chevron-down':'glyphicon-chevron-right'"></span> Erweitert</div>
								
								<div class="form-group" ng-show="item.formExtend">
									<label for="docCreationPlace" class="control-label col-sm-3">Erstellungsort</label>
									<div class="col-sm-8">
										<input type="text" class="form-control" ng-model="item.creationPlace" ng-focus="setTypeaheadArray('E48','content')" ng-blur="validateInput2(item)" bs-typeahead bs-options="ta.content as ta.content for ta in suggestions" placeholder="z.B. Jerusalem" bs-tooltip="{title: 'Wo wurde die Quelle erstellt?'}"/>
									</div>
								</div>
								
								<div class="form-group" ng-show="item.formExtend">
									<label for="docCollect" class="control-label col-sm-3">Archiv</label>
									<div class="col-sm-6">
										<select class="form-control input-sm" ng-model="item.archive" bs-tooltip="{title: 'Archiv, Sammlung oder Kollektion'}">
											<option value="">Keine Angabe</option>
											<option ng-repeat="a in archives" value="{{a.collection}}">{{a.institutionAbbr || a.institutionName}} {{a.collectionName}}</option>
										</select>
									</div>
									<div class="col-sm-3">
										<button class="btn btn-default btn-sm" ng-click="addArchive()">Hinzufügen</button>
									</div>
								</div>
								
								<div class="form-group" ng-show="item.formExtend">
									<label for="docArchiveNr" class="control-label col-sm-3">Archivkennung</label>
									<div class="col-sm-8">
										<input type="text" class="form-control" ng-model="item.archiveNr" ng-focus="setTypeaheadArray('E42','content')" ng-blur="validateInput2(item)" bs-typeahead bs-options="ta.content as ta.content for ta in suggestions" placeholder="z.B. P.E.F. Schick|202|3" bs-tooltip="{title: 'Archiv- oder Regalnummer'}"/>
									</div>
								</div>
								
								<div class="form-group" ng-show="item.formExtend && item.sourceType == 'text'">
									<label for="docOCR" class="control-label col-sm-3">Texterkennung</label>
									<div class="col-sm-1">
										<input type="checkbox" ng-model="item.ocr"  bs-tooltip="{title: 'Handelt es sich um einen eingescannten Text, empfiehlt sich eine automatische Texterkennung'}"/>
									</div>
									<label for="docResample" class="control-label col-sm-2">Resample</label>
									<div class="col-sm-1">
										<input type="checkbox" ng-model="item.resample"  bs-tooltip="{title: 'Sollte das Dokument eine schlechte Auflösung besitzen, kann ein Hochskalierung das OCR-Ergebnis verbessern.'}"/>
									</div>
								</div>
								
								<div class="form-group" ng-show="item.formExtend && (item.sourceType == 'plan' || item.sourceType == 'picture')">
									<label for="docPrimary" class="control-label col-sm-3"></label>
									<div class="col-sm-8" bs-tooltip="{title: 'Primär- oder Sekundärquelle?'}">
										<label class="radio-inline">
											<input type="radio" name="radioPrimary" ng-model="item.primary" ng-value="true"/> Primärquelle
										</label>
										<label class="radio-inline">
											<input type="radio" name="radioPrimary" ng-model="item.primary" ng-value="false"/> Sekundärquelle
										</label>
									</div>
								</div>
								
								<div class="form-group large">
									<label for="tags" class="control-label col-sm-3">Tags</label>
									<div class="col-sm-8">
										<tags-input ng-model="item.tags" placeholder="Schlagwort" on-tag-added="onTagAdded($tag)">
											<auto-complete source="getTags($query)" debounce-delay="200" select-first-match="true"></auto-complete>
										</tags-input>
									</div>
								</div>
								
							</form>
						</td>
						
						<td width="100" ng-show="uploader.isHTML5">
							<div class="progress" style="margin-bottom: 0;">
								<div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
							</div>
						</td>
						
						<td width="60" class="text-center">
							<img ng-show="item.isProcessing" src="img/ajax-loader.gif"/> 
							<img ng-show="item.isInserting" src="img/db_write.gif"/>
							<span ng-show="item.isSuccess && !item.isInserting"><i class="glyphicon glyphicon-ok"></i></span>
							<span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
							<span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
						</td>
						
						<td width="30">
							<a ng-click="item.remove()">
								<span class="glyphicon glyphicon-trash"></span>
							</a>
						</td>
					</tr>
					
					<!-- Modelle und andere Dateien -->
					
					<tr ng-if="uploadType == 'model' || uploadType == 'zip'" ng-repeat="item in uploader.queue" ng-class="{success: item.isSuccess && !item.isInserting, danger: item.isError}">
						<td class="uploadMeta">
							<strong>{{ item.file.name }}</strong>
							&emsp; <small>{{ item.file.size/1024/1024|number:2 }} MB</small>
						</td>
						
						<td width="100" ng-show="uploader.isHTML5">
							<div class="progress" style="margin-bottom: 0;">
								<div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
							</div>
						</td>
						
						<td width="60" class="text-center">
							<img ng-show="item.isProcessing" src="img/ajax-loader.gif"/> 
							<img ng-show="item.isInserting" src="img/db_write.gif"/> 
							<span ng-show="item.isSuccess && !item.isInserting"><i class="glyphicon glyphicon-ok"></i></span>
							<span ng-show="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
							<span ng-show="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
						</td>
						
						<td width="30">
							<a ng-click="item.remove()">
								<span class="glyphicon glyphicon-trash"></span>
							</a>
						</td>
					</tr>
				</tbody>
			</table>
			</div>
			
		</div>
		
	</div>
	
	<div class="modal-footer">
		<button type="button" class="btn btn-primary" ng-click="checkAndUploadAll()" ng-disabled="!uploader.getNotUploadedItems().length">
			<span class="glyphicon glyphicon-upload"></span> Hochladen
		</button>
	
		<button type="button" class="btn btn-default" ng-click="close()">Abbrechen</button>
	</div>
	
</div>

